---
title: "Final Project"
subtitle: "Data Science for Biologists, Spring 2021"
author: "Holly Felker"
output: 
  html_document:
    theme: spacelab
    highlight: breezedark
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
# DON'T CHANGE THE NEXT LINE, except to add NEW options if you have any.
knitr::opts_chunk$set(warning=FALSE, message=FALSE, echo = TRUE, include = TRUE)

# Load all libraries you use HERE:

library(tidyverse)
library(colorblindr)
```

<br><br>

## Introduction

This dataset is a large compilation of all of the sightings of squirrels within Central Park in New York City over a two week period in 2018. It details their age, coloring, location, and behaviours of over 3000 squirrels. 

I chose this dataset at first because I'd wanted to do something with animals while looking through the past Tidy Tuesdays, and all of the information about the squirrels seemed interesting. Then I actually read through the Squirrel Census website and honestly, it's really charming and cute, and made me want to look into their data that much more. Squirrels in general are adorable and smart (they can remember where they've buried a single nut in a large park for a couple years afterwards, and they will even mimic burying nuts to confuse other "thief" squirrels and birds), and it will be cool to look into a large population dataset of them and see how they generally act.

<br>
You can find the [NYC Squirrel Census data here](https://github.com/rfordatascience/tidytuesday/tree/master/data/2019/2019-10-29). 

(I would recommend also reading the actual [Squirrel Census](https://www.thesquirrelcensus.com/) webpage that the data is from because it's *wild*)

<center>

![*Picture taken from Squirrel Census website*](https://images.squarespace-cdn.com/content/v1/603eb468703ac05daa645759/1615241445862-14IGJV192HTVQU5L40N7/ke17ZwdGBToddI8pDm48kHUV6dDLfCQ4HBz_x2OKkK9Zw-zPPgdn4jUwVcJE1ZvWhcwhEtWJXoshNdA9f1qD7bNalm2hBiow6Ud3tcGmvvHIF2jj_e0-UIP_F6xVGbtXQQjOVi2ID8SIgmDZ4pM6MA/squirrel_haunches_web.png?format=300w)

</center>

```{r read-examine-data}

squirrels <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-10-29/nyc_squirrels.csv")

dplyr::glimpse(squirrels)

```

<br><br>

## Question 1

#### How many squirrels were found in trees compared to on the ground?

### Methods

```{r question_1, fig.width = 6, fig.height = 4}

squirrels %>%
  select(unique_squirrel_id, location) %>% #looking for squirrels and their locations
  distinct() %>% #only getting distinct squirrels and IDs
  drop_na() %>% #getting rid of all unknown locations
  arrange(unique_squirrel_id) %>% #this is literally just for me as I'm slowly working my way through organising the tibble
  group_by(location) %>% 
  count(location) %>% #getting the location count
  ungroup() %>% #must ungroup!
ggplot(aes(x = location, y = n)) + #graph time!
  geom_col(aes(fill = location), width = 0.5, color = "black") + #So I did end up putting an outline around these too (you'll find out later what I mean)
  geom_text(aes(label = n), nudge_y = 100) + #it took a bit to remember how to add and fix my labels
  scale_fill_manual(values = c("deepskyblue", "forestgreen")) + #color coding for the different locations
  theme_classic() +
  theme(legend.position = "none") + #don't need the legend for this one
  labs(x = "Squirrel Location", y = "Number of Squirrels") -> ground_plot


#cvd_grid(ground_plot)    checked before finalising that the graph was colorblind-friendly and it looks good!

print(ground_plot) #printing the graph so it shows in the html

```


### Answer

There were many more squirrels found on the ground than there were in the trees. Of the squirrels that had their locations noted, 2111 of them were first seen on the ground, while only 843 of them were seen in trees.


<br><br>

## Question 2

#### Is there a trend of squirrels behaving a certain way around humans depending on their age?

### Methods

```{r question_2, fig.height = 5, fig.width = 8}

squirrels %>%
  select(unique_squirrel_id, age, approaches, indifferent, runs_from) %>% #getting the necessary columns
  distinct() %>%
  drop_na() %>% #same distinctness and getting rid of NA values
  group_by(age) %>%
  filter(age != "?") %>% #there were some where they didn't know the age of the squirrel, but I got rid of those
  rename(c("Approaches Human" = approaches, 
           "Indifferent towards Human" = indifferent, 
           "Runs from Human" = runs_from)) %>% #renaming all of them so it looks better in the plot
  pivot_longer(cols = c("Approaches Human", 
                        "Indifferent towards Human", 
                        "Runs from Human"), 
               names_to = "behaviour", values_to = "value") %>% #pivoting it so everything is tidier
  filter(value != "FALSE") %>% #only want the true values
  count(behaviour) %>% 
  ungroup() %>% #almost forgot to ungroup!
ggplot(aes(x = behaviour, y = n)) +
  geom_point(aes(fill = behaviour), shape = 23, size = 4) + #getting ~fancy~ with the shapes
  geom_segment(aes(xend = behaviour, y = 0, yend = n)) + #made a lollipop plot for flavor
  geom_text(aes(label = n), nudge_x = 0.25) + #hey I can actually see the values now
  scale_fill_manual(values = c("deeppink", "gold", "forestgreen")) +
  facet_wrap(vars(age), scales = "free") + #separating them by the different ages
  theme_classic() +
  theme(legend.position = "none", 
        strip.background = element_rect(fill = "skyblue"),
        axis.text.x = element_text(angle = 30, vjust = 0.5)) + #making a nice background strip color
  labs(x = "Squirrel Behaviour", y = "Number of Squirrels") -> behaviour_plot

 
#cvd_grid(behaviour_plot)   passes the colorblind test

print(behaviour_plot)


```


### Answer

It doesn't really seem as though age plays much of a factor in squirrel behaviour. Although far more adults than juveniles were recorded, in both age groups, the most common behaviour seen was that they were indifferent towards nearby people. I had previously thought that possibly the juveniles might have approached the humans more because they'd be naive and curious; or that there would have been a larger number of adult squirrels who approached people if they had learned that people would give them bits of food while walking around Central Park, but neither of these seem to be the case. There is no significant difference in the behaviour trends between adult and juvenile squirrels. The majority in both age groups were indifferent towards humans while the least common behaviour was that the squirrels actually approached them.


<br><br>

## Question 3

#### What percentage of squirrels have a cinnamon primary fur color?

### Methods

```{r, question_3, fig.height = 4, fig.width = 6}

squirrels %>%
  select(unique_squirrel_id, primary_fur_color) %>% #only want to deal with primary fur colors, not the highlights
  distinct() %>%
  drop_na() %>% #the usual distinct, drop_na 
  group_by(primary_fur_color) %>%
  count() -> sqrrl

sum(sqrrl$n) -> total #this is an annoying way to get percentages but it works I guess

sqrrl %>% 
  mutate(percentage = n / sum(total) *100) %>% #please let me know if there's some better way with an easy couple commands or if I'm stuck like this
ggplot(aes(x = primary_fur_color, y = percentage)) +
  geom_col(aes(fill = primary_fur_color), color = "black") + #I should probably go back and also put an outline around the first bar graph so it looks neater
  geom_text(aes(label = round(percentage, digits = 2)), nudge_y = 5) + #2 decimal points for everything
  scale_fill_manual(values = c("black", "chocolate", "lightgrey")) + #close recreations of actual fur colors
  labs(x = "Squirrel Fur Color", y = "Percentage") +
  theme_classic() + #making it look pretty
  theme(legend.position = "none") -> fur_plot 
  
#cvd_grid(fur_plot)   color-blind friendly!
  
print(fur_plot)



```


### Answer

13.23% of the squirrels seen in Central Park had a cinnamon primary fur color, though the majority of them were grey. There were also a large amount of squirrels with cinnamon "highlights" in addition to their other primary fur color, though the exact percentage of those is not answered with this graph. <br><br>
(Maybe if I have time at the end I'll also look at highlights too, but I might just leave it. That'd be a lot more complicated with using `select(contains("cinnamon"))` for the squirrels with multiple highlight colors)


<br><br>

## Question 4

#### Where were the most squirrels found over the 2 week period?

### Methods

```{r, question_4}

#Get the list of all the hectares, then plot the top 10? (or top 5 or something)

squirrels %>%
  filter()


```


### Answer

Replace this text with your answer to your question.
